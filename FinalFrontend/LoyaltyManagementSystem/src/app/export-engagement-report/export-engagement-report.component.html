<div class="export-report-container">
  <div class="export-header">
    <h2>Export Engagement Report</h2>
    <span class="role-badge">Super Admin</span>
  </div>

  <!-- A. Report Type Selection -->
  <div class="section">
    <h3>Report Type</h3>
    <div class="report-types">
      <label *ngFor="let type of reportTypes">
        <input type="radio" name="reportType" [checked]="selectedReportType === type" (change)="onReportTypeChange(type)" /> {{ type }}
      </label>
    </div>
  </div>

  <!-- B. Date Range Filter -->
  <div class="section">
    <h3>Date Range</h3>
    <div class="date-range-row">
      <select [(ngModel)]="selectedDateRange" (change)="onDateRangeChange(selectedDateRange)">
        <option *ngFor="let range of dateRanges">{{ range }}</option>
      </select>
      <input type="date" [(ngModel)]="dateStart" [disabled]="selectedDateRange !== 'Custom'" />
      <span>to</span>
      <input type="date" [(ngModel)]="dateEnd" [disabled]="selectedDateRange !== 'Custom'" />
    </div>
  </div>

  <!-- E. Export Options -->
  <div class="section">
    <h3>Export Options</h3>
    <div class="export-options-row">
      <label>Format:
        <select [(ngModel)]="selectedFormat">
          <option *ngFor="let f of exportFormats">{{ f }}</option>
        </select>
      </label>
      <button class="export-btn" (click)="exportReportAsCSV()">Download</button>
      <button class="email-btn" (click)="onEmailCSV()">Email CSV</button>
      <input type="email" placeholder="Email to (comma separated)" [(ngModel)]="emailTo" />
      <button class="schedule-btn" (click)="onScheduleExport()">Schedule Export</button>
      <select [(ngModel)]="selectedSchedule">
        <option *ngFor="let s of scheduleOptions">{{ s }}</option>
      </select>
      <input type="text" placeholder="SFTP Location (optional)" [(ngModel)]="sftpLocation" />
    </div>
  </div>

  <!-- G. Preview Data -->
  <div class="section preview-section">
    <h3>Preview Data</h3>
    <table class="preview-table">
      <thead>
        <tr>
          <th *ngFor="let col of columns" [hidden]="!col.selected">{{ col.label }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of previewData">
          <td *ngIf="columns[0].selected">{{ row.userId }}</td>
          <td *ngIf="columns[1].selected">{{ row.email }}</td>
          <td *ngIf="columns[2].selected">-</td>
          <td *ngIf="columns[3].selected">{{ row.lastActivity }}</td>
          <td *ngIf="columns[4].selected">{{ row.pointsEarned }}</td>
          <td *ngIf="columns[5].selected">{{ row.pointsRedeemed }}</td>
          <td *ngIf="columns[6].selected">{{ row.currentBalance }}</td>
          <td *ngIf="columns[7].selected">{{ row.lastActivity }}</td>
          <td *ngIf="columns[8].selected">-</td>
          <td *ngIf="columns[9].selected">-</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- F. Export Logs -->
  <div class="section">
    <h3>Export Logs</h3>
    <table class="logs-table">
      <thead>
        <tr>
          <th>Date & Time</th>
          <th>Report Type</th>
          <th>Filters</th>
          <th>Generated By</th>
          <th>Format</th>
          <th>Download</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let log of logs">
          <td>{{ log.dateTime }}</td>
          <td>{{ log.reportType }}</td>
          <td>{{ log.filters }}</td>
          <td>{{ log.generatedBy }}</td>
          <td>{{ log.format }}</td>
          <td><a [href]="log.downloadUrl" class="download-link">Download</a></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>